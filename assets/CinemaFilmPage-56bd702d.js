import{E as ae,H as se,G as te,q as P,M as ie,N as le}from"./base-ad0068b1.js";import{E as oe}from"./el-button-7195a193.js";/* empty css                */import{_ as ne,r as _,o as ce,X as de,j as q,S as ue,u as re,c as a,g as o,F as I,i as e,d as S,w as f,t as n,C as G,M as J,h as F,e as d,J as C,Y as M,T as ve,p,n as O,a1 as _e,a2 as fe}from"./index-35cb0dd4.js";import{S as me}from"./ScheduleDateList-a69cb1a2.js";import{_ as he}from"./LoadingMod-b2d8dc0e.js";import{E as pe}from"./request-8cf98847.js";import{d as ge,e as we,f as ke}from"./cinimas-19f5ddcc.js";import{S as ye}from"./swiper-0c4193be.js";import{d as Ie}from"./dayjs.min-5433e12a.js";import"./index-06758cc8.js";import"./icon-56d47907.js";import"./index-e90ec287.js";import"./size-a5a08e6d.js";const Se=g=>(_e("data-v-95ceda1d"),g=g(),fe(),g),Ce={class:"cinema-film-container"},xe={class:"nav-bar"},De={class:"cinema-title"},be={class:"wrap"},Le={key:0},$e={class:"cinema-address"},ze={class:"address line-overflow"},Fe=["href"],Be={class:"film-bar"},Ee={class:"film-poster"},Me={class:"bg"},Ne=["src"],Te={class:"swiper"},Ve={class:"swiper-wrapper"},je={class:"poster"},Ae=["src"],He={class:"film-main-info"},Pe={key:0,class:"film-grade"},qe={class:"film-sub-info"},Ge={class:"content line-overflow"},Je={class:"schedule"},Oe={class:"schedule-list"},Re={class:"item-left"},Xe={class:"time"},Ye={class:"star-at"},Ke={class:"end-at"},Qe={class:"hall"},Ue={class:"film-language"},We={class:"hall-place"},Ze={class:"item-right"},ea=Se(()=>e("div",{class:"price"},"￥"+n(0),-1)),aa={class:"services-info"},sa={class:"info-name"},ta={class:"info-description"},ia={__name:"CinemaFilmPage",props:["cid","fid"],setup(g){const w=_(!1),{cid:x,fid:N}=g,k=_(!1),D=_(x?+x:-1),u=_(N?+N:-1),h=_(-1),m=_(),i=_([]),l=_(0);ce(R);async function R(){w.value=!0;const t=await ge(x);m.value=t.data.data.cinema;const c=await we(x);i.value=c.data.data.films,u.value===-1&&(u.value=i.value[0].filmId),l.value=i.value.findIndex(r=>r.filmId===u.value),h.value=i.value[l.value].showDate[0],await E(),w.value=!1,de(()=>{new ye(".swiper",{slidesPerView:4,centeredSlides:!0,initialSlide:l.value,on:{slideChange:Y}})})}const X=q(()=>{if(!i.value.length)return;const{category:t,runtime:c,director:r,actors:b}=i.value[l.value],L=b.reduce(($,z)=>$+z.name+" ","");return[t,c+"分钟",r,L].join(" | ")});async function Y(){l.value=this.activeIndex,u.value=+i.value[l.value].filmId,h.value=i.value[l.value].showDate[0],await E(),y.replace({params:{fid:u.value,cid:D.value}})}const B=ue({}),T=_(0);async function E(){const t=`${u.value}:${D.value}:${h.value}`;if(B[t])return;const c=await ke({filmId:u.value,cinemaId:D.value,date:h.value});B[t]=c.data.data.schedules}const K=q(()=>{const t=`${u.value}:${D.value}:${h.value}`;return B[t]});async function Q(t,c){h.value=t,T.value=c,y.replace({params:{fid:u.value,date:t}}),await E()}function V(t){return Ie(t*1e3).format("HH:MM")}function j(t){return new Date().getTime()>t*1e3}function U(){y.push({name:"login"})}function W(){pe("当前场次已经停止售票,请选择其它场次")}const y=re();function Z(){y.back()}function ee(){y.push({name:"film",params:{fid:u.value}})}return(t,c)=>{var L,$,z,A,H;const r=ae,b=oe;return a(),o("div",Ce,[w.value?C("",!0):(a(),o(I,{key:0},[e("div",xe,[k.value?(a(),S(r,{key:1,style:{"margin-left":"12px"},size:"26",onClick:c[0]||(c[0]=s=>k.value=!1)},{default:f(()=>[d(p(te))]),_:1})):(a(),S(r,{key:0,style:{"margin-left":"12px"},size:"26",onClick:Z},{default:f(()=>[d(p(se))]),_:1}))]),e("div",De,n((L=m.value)==null?void 0:L.name),1),G(e("div",be,[m.value?(a(),o("div",Le,[m.value.services?(a(),o("div",{key:0,class:"cinema-tags",onClick:c[1]||(c[1]=s=>k.value=!0)},[(a(!0),o(I,null,F(m.value.services,(s,v)=>(a(),o("div",{class:"tag-btn",key:v},n(s.name),1))),128)),d(r,{color:"#fcb13c",size:"10"},{default:f(()=>[d(p(P))]),_:1})])):C("",!0),e("div",$e,[d(r,{size:"20"},{default:f(()=>[d(p(ie))]),_:1}),e("div",ze,n(m.value.address),1),e("a",{href:`tel:${m.value.phone}`,class:"phone"},[d(r,{size:"20",class:"phone-icon"},{default:f(()=>[d(p(le))]),_:1})],8,Fe)])])):C("",!0),e("div",Be,[e("div",Ee,[e("div",Me,[e("img",{src:($=i.value[l.value])==null?void 0:$.poster},null,8,Ne)]),e("div",Te,[e("div",Ve,[(a(!0),o(I,null,F(i.value,(s,v)=>(a(),o("div",{class:"swiper-slide",key:s},[e("div",je,[e("img",{class:O({active:v===l.value}),src:s.poster},null,10,Ae)])]))),128))])])]),e("div",{class:"film-info",onClick:ee},[e("div",He,[e("div",null,n((z=i.value[l.value])==null?void 0:z.name),1),(A=i.value[l.value])!=null&&A.grade?(a(),o("div",Pe,[e("span",null,n(i.value[l.value].grade),1),M(" 分 ")])):C("",!0)]),e("div",qe,[e("div",Ge,n(X.value),1)]),d(r,{class:"right-btn",size:"12"},{default:f(()=>[d(p(P))]),_:1})])]),e("div",Je,[d(me,{showDate:(H=i.value[l.value])==null?void 0:H.showDate,activeIndex:T.value,onClickItem:Q},null,8,["showDate","activeIndex"]),e("div",Oe,[(a(!0),o(I,null,F(K.value,(s,v)=>(a(),o("div",{class:O(["list-item",{stop:j(s.showAt)}]),key:v},[e("div",Re,[e("div",Xe,[e("div",Ye,n(V(s.showAt)),1),e("div",Ke,n(V(s.endAt))+"散场 ",1)]),e("div",Qe,[e("div",Ue,n(s.filmLanguage+s.imagery),1),e("div",We,n(s.hallName),1)])]),e("div",Ze,[ea,j(s.showAt)?(a(),S(b,{key:1,color:"#d2d6dc",size:"small",plain:"",onClick:W},{default:f(()=>[M("停售")]),_:1})):(a(),S(b,{key:0,color:"#fb5e1e",size:"small",plain:"",onClick:U},{default:f(()=>[M("购票")]),_:1}))])],2))),128))])])],512),[[J,!k.value]]),d(ve,{mode:"out-in","enter-active-class":"animate__animated animate__fadeInDown"},{default:f(()=>{var s;return[G(e("div",aa,[(a(!0),o(I,null,F((s=m.value)==null?void 0:s.services,v=>(a(),o("div",{class:"info-item",key:v.name},[e("div",sa,n(v.name),1),e("div",ta,n(v.description),1)]))),128))],512),[[J,k.value]])]}),_:1})],64)),w.value?(a(),S(he,{key:1,full:"",flag:w.value},null,8,["flag"])):C("",!0)])}}},wa=ne(ia,[["__scopeId","data-v-95ceda1d"]]);export{wa as default};
